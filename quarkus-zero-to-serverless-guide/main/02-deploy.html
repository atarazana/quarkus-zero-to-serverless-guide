<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Quarkus from Zero to Serverless Guide :: Quarkus from Zero to Serverless Guide</title>
    <link rel="canonical" href="https://atarazana.github.io/quarkus-zero-to-serverless-guide/quarkus-zero-to-serverless-guide/main/02-deploy.html">
    <link rel="prev" href="01-setup.html">
    <link rel="next" href="03-deploy-database.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../_/css/site.css">
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img
          src="../../_/img/header_logo.png" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" href="https://atarazana.github.io/quarkus-zero-to-serverless-guide">Quarkus from Zero to Serverless Guide</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Books</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">CheatSheets</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">CheatSheet A</a>
            <a class="navbar-item" href="#">CheatSheet B</a>
            <a class="navbar-item" href="#">CheatSheet C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Upcoming Events</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Event A</a>
            <a class="navbar-item" href="#">Event B</a>
            <a class="navbar-item" href="#">Event C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Tutorial A</a>
            <a class="navbar-item" href="#">Tutorial B</a>
            <a class="navbar-item" href="#">Tutorial C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="quarkus-zero-to-serverless-guide" data-version="main">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Quarkus from Zero to Serverless Guide</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="01-setup.html">1. Setup</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-setup.html#getting-ready">Getting Ready for the labs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-setup.html#login-to-openshift">Login To OpenShift</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02-deploy.html">2. Deploying the Atomic Fruit Service</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#generate-the-quarkus-app-scaffold-using-a-maven-archetype">Generate the Quarkus app scaffold using a maven archetype</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#testing-different-ways-of-packaging-the-app">Testing different ways of packaging the app</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#running-in-development-mode-and-enjoy-hot-reloading">Running in development mode and enjoy hot reloading</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03-deploy-database.html">3. Adding a Data Base to our application</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-deploy-database.html#deploying-postgresql">Deploying PostgreSQL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-deploy-database.html#deploy">Deploy the Application</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-deploy-database.html#adding-db-related-extensions">Adding DB related extensions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-deploy-database.html#exposing-rest-endpoints-for-crud-operations">Exposing REST endpoints for CRUD operations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-deploy-database.html#testing-locally">Testing locally</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="04-deploy-openshift.html">4. Deploying the Atomic Fruit Service on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-deploy-openshift.html#deploying-to-openshift">Deploying to OpenShift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-deploy-openshift.html#evolving-to-serverless">Evolving to Serverless</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="05-annex.html">ANNEX: Packing &amp; building by using Docker</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-annex.html#native-mode-ii-generated-in-a-container">Native Mode II (generated in a container)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-annex.html#automatic-build-for-jvm-mode-using-docker">Automatic build for JVM mode using <code>docker</code></a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-annex.html#automatic-build-for-native-mode-using-docker">Automatic build for Native mode using <code>docker</code></a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-annex.html#s2i-native-build">S2i Native Build</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Quarkus from Zero to Serverless Guide</span>
    <span class="version">main</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Quarkus from Zero to Serverless Guide</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">main</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Quarkus from Zero to Serverless Guide</a></li>
    <li><a href="02-deploy.html">2. Deploying the Atomic Fruit Service</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/atarazana/quarkus-zero-to-serverless-guide/edit/main/documentation/modules/ROOT/pages/02-deploy.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Quarkus from Zero to Serverless Guide</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The purpose of this section is to explain step by step how to build a simple CRUD service using Quarkus starting from scratch. Then you will learn how to enhance it by adding extensions and finally you will deploy it in OpenShift.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="generate-the-quarkus-app-scaffold-using-a-maven-archetype"><a class="anchor" href="#generate-the-quarkus-app-scaffold-using-a-maven-archetype"></a>Generate the Quarkus app scaffold using a maven archetype</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default, the command will target the latest version of <code>quarkus-universe-bom</code> (unless specific coordinates have been specified). If you run offline however, it will look for the latest locally available and if <code>quarkus-universe-bom</code> (satisfying the default version range which is currently up to 2.0) is not available locally, it will fallback to the bundled platform based on <code>quarkus-bom</code> (the version will match the version of the plugin).</p>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sh hljs" data-lang="sh">mvn io.quarkus:quarkus-maven-plugin:1.7.6.Final-redhat-00014:create \
  -DprojectGroupId="com.redhat.atomic.fruit" \
  -DprojectArtifactId="atomic-fruit-service" \
  -DprojectVersion="1.0-SNAPSHOT" \
  -DclassName="FruitResource" \
  -Dpath="fruit"</code></pre>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>If you decide to generate a REST resource (using the <code>className</code> attribute), the endpoint is exposed at: <a href="http://localhost:8080/$path" class="bare">http://localhost:8080/$path</a>. If you use the default <code>path</code>, the URL is: <a href="http://localhost:8080/hello" class="bare">http://localhost:8080/hello</a>.</p>
</div>
<div class="paragraph">
<p>The project is generated in a directory named after the passed artifactId. If the directory already exists, the generation fails.</p>
</div>
<div class="paragraph">
<p>A pair of Dockerfiles for native and jvm mode are also generated in <code>src/main/docker</code>. Instructions to build the image and run the container are written in those Dockerfiles.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing-different-ways-of-packaging-the-app"><a class="anchor" href="#testing-different-ways-of-packaging-the-app"></a>Testing different ways of packaging the app</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
At this point you must be compliant with all the prerequisites describes in the <a href="01-setup.html" class="page">setup section</a> and be inside the app dir <code>atomic-fruit-service</code> you just created in the previous section.
</td>
</tr>
</table>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sh hljs" data-lang="sh">cd $CHE_PROJECTS_ROOT/atomic-fruit-service</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="jvm-mode"><a class="anchor" href="#jvm-mode"></a>JVM mode</h3>
<div class="paragraph">
<p>This mode generates a Quarkus Java jar file.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Don&#8217;t forget to add <code>unset MAVEN_CONFIG</code> if you open a new terminal!
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Generate <code>jar</code></p>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sh hljs" data-lang="sh">mvn -DskipTests clean package</code></pre>
</div>
</div>
</li>
<li>
<p>Run the application in JVM mode.</p>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sh hljs" data-lang="sh">java -jar ./target/atomic-fruit-service-1.0-SNAPSHOT-runner.jar <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
</li>
<li>
<p>Test from another terminal, you should receive a <code>hello</code> string.</p>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sh hljs" data-lang="sh">curl http://localhost:8080/fruit</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><strong><em>Ctrl+C</em> to stop.</strong></td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="native-mode-i"><a class="anchor" href="#native-mode-i"></a>Native Mode I</h3>
<div class="paragraph">
<p>This mode generates a Quarkus native binary file.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This is huge&#8230;&#8203; now you have a native binary file, no JVM involved.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Generate the binary</p>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sh hljs" data-lang="sh">mvn -DskipTests clean package -Pnative</code></pre>
</div>
</div>
</li>
<li>
<p>Run the application in native mode.</p>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sh hljs" data-lang="sh">./target/atomic-fruit-service-1.0-SNAPSHOT-runner <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
</li>
<li>
<p>Test from another terminal, you should receive a <code>hello</code> string.</p>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sh hljs" data-lang="sh">curl http://localhost:8080/fruit</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><strong><em>Ctrl+C</em> to stop.</strong></td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>There is second mode from the Native perspective, a way of creating a native Linux executable by leveraging a container runtime such as <code>docker</code> or <code>podman</code>.
This is outside of the scope of this lab but if you want to know more about this approach, we describe it for you in the Annex: <a href="05-annex.html#native-mode-ii-generated-in-a-container" class="page">Native Mode II (generated in a container)</a></p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="running-in-development-mode-and-enjoy-hot-reloading"><a class="anchor" href="#running-in-development-mode-and-enjoy-hot-reloading"></a>Running in development mode and enjoy hot reloading</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We can run our app in development mode, to do so we have to do as follows:</p>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sh hljs" data-lang="sh">mvn quarkus:dev</code></pre>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title"><code>quarkus:dev</code></div>
<div class="paragraph">
<p>Enables hot deployment with background compilation, which means that when you modify your Java files or your resource files and refresh your browser these changes will automatically take effect. This works too for resource files like the configuration property file. The act of refreshing the browser triggers a scan of the workspace, and if any changes are detected the Java files are compiled, and the application is redeployed, then your request is serviced by the redeployed application. If there are any issues with compilation or deployment an error page will let you know.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>As we have done several times before, from a different terminal try this url: <a href="http://localhost:8080/fruit" class="bare">http://localhost:8080/fruit</a></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The first time you build the app, new dependencies may be downloaded via maven. This should only happen once, after that things will go even faster</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You may see WARNINGs like <code>Unrecognized configuration key</code> or <code>Duplicate entry</code>. These are configuration values that will take effect later on and can be safely ignored for now.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You should see:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">2020-11-03 14:27:00,102 INFO  [io.quarkus] (Quarkus Main Thread) people 1.0-SNAPSHOT on JVM (powered by Quarkus x.x.x) started in 0.972s. Listening on: http://0.0.0.0:8080
2020-11-03 14:27:00,102 INFO  [io.quarkus] (Quarkus Main Thread) Profile dev activated. Live Coding activated.
2020-11-03 14:27:00,103 INFO  [io.quarkus] (Quarkus Main Thread) Installed features: [cdi, resteasy]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note the amazingly fast startup time! The app is now running "locally" (within the Che container in which the workspace is also running). <code>localhost</code> refers to the Kubernetes pod, not "your" laptop (so therefore opening localhost:8080 in your browser will not do anything).</p>
</div>
<div class="paragraph">
<p>CodeReady will also detect that the Quarkus app opens <code>8080</code> (for web requests). When prompted, <strong>Open in Preview</strong>, which opens a small web browser in CodeReady:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/open-preview.png" alt="port" width="700">
</div>
</div>
<div class="paragraph">
<p>You should see the default Quarkus welcome page (you may need to click the <em>reload</em> icon):</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/welcome-quarkus.png" alt="port" width="900">
</div>
</div>
<div class="paragraph">
<p>Open a <strong>new</strong> CodeReady Workspaces Terminal:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/cmd-terminal.png" alt="livecoding" width="900">
</div>
</div>
<div class="paragraph">
<p>and invoke the <code>fruit</code> endpoint using the following <em>curl</em> command:</p>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sh hljs" data-lang="sh">curl http://localhost:8080/fruit</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also click on the URL link at the upper right to open the same default page in a separate browser tab:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/crw-open-page.png" alt="page" width="800">
</div>
</div>
<div class="paragraph">
<p>Add <code>/fruit</code> in your browser to see the same result as the <em>curl</em> command:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/crw-open-page-fruit.png" alt="page" width="800">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This will also listen for a debugger on port <code>5005</code>. If you want to wait for the debugger to attach before running you can pass <code>-Ddebug</code> on the command line. If you don’t want the debugger at all you can use <code>-Ddebug=false</code>. We&#8217;ll use this later.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now, without stopping our application, let's add some logging&#8230;&#8203;</p>
</div>
<div class="sect2">
<h3 id="adding-log-capabilities"><a class="anchor" href="#adding-log-capabilities"></a>Adding log capabilities</h3>
<div class="paragraph">
<p>Internally Quarkus uses JBoss Logging; you can also use it inside your application so that no other dependencies should be added for your logs.</p>
</div>
<div class="paragraph">
<p>In order to add logging capabilities to your app follow the next steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Configure Quarkus logging by setting the following parameters to <code>atomic-fruit-service/src/main/resources/application.properties</code>:</p>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">## Enable logging
quarkus.log.console.enable=true
quarkus.log.console.level=DEBUG

## Log level settings
quarkus.log.category."com.redhat.atomic".level=DEBUG</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Keep it open as you are going to use it frequently during all the lab.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Navigate to <code>src → main → java → com.redhat.atomic.fruit</code> in the project tree starting at folder <code>atomic-fruit-service</code> and double click on <code>FruitResource.java</code>. Update with the code bellow, replacing all the existing code:</p>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package com.redhat.atomic.fruit;

import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;

import org.jboss.logging.Logger; // logging

@Path("/fruit")
public class FruitResource {
  Logger logger = Logger.getLogger(FruitResource.class); // logging

  @GET
  @Produces(MediaType.TEXT_PLAIN)
  public String hello() {
      logger.debug("Hello method is called"); // logging
      return "hello";
  }
}</code></pre>
</div>
</div>
</li>
<li>
<p>From a different terminal try again this url: <a href="http://localhost:8080/fruit" class="bare">http://localhost:8080/fruit</a></p>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sh hljs" data-lang="sh">curl http://localhost:8080/fruit</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output should be something similar as follows (pay attention to the last trace, <strong>DEBUG</strong>):</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">2021-03-31 16:32:26,809 INFO  [io.quarkus] (Quarkus Main Thread) atomic-fruit-service stopped in 0.000s
__  ____  __  _____   ___  __ ____  ______
 --/ __ \/ / / / _ | / _ \/ //_/ / / / __/
 -/ /_/ / /_/ / __ |/ , _/ ,&lt; / /_/ /\ \
--\___\_\____/_/ |_/_/|_/_/|_|\____/___/
2021-03-31 16:32:26,943 INFO  [io.quarkus] (Quarkus Main Thread) atomic-fruit-service 1.0-SNAPSHOT on JVM (powered by Quarkus 1.9.2.Final) started in 0.131s. Listening on: http://0.0.0.0:8080
2021-03-31 16:32:26,943 INFO  [io.quarkus] (Quarkus Main Thread) Profile dev activated. Live Coding activated.
2021-03-31 16:32:26,943 INFO  [io.quarkus] (Quarkus Main Thread) Installed features: [cdi, resteasy]
2021-03-31 16:32:26,943 INFO  [io.qua.dep.dev.RuntimeUpdatesProcessor] (vert.x-worker-thread-7) Hot replace total time: 0.201s
2021-03-31 16:32:26,946 DEBUG [com.red.ato.fru.FruitResource] (executor-thread-199) Hello method is called</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The console log handler is enabled by default. It outputs all log events to the console of your application (typically to the system’s <code>stdout</code>).</p>
</div>
<div class="paragraph">
<p>For details of its configuration options, see <a href="https://quarkus.io/guides/logging#quarkus-log-logging-log-config_quarkus.log.console">the Console Logging configuration reference</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="adding-custom-properties"><a class="anchor" href="#adding-custom-properties"></a>Adding custom properties</h3>
<div class="paragraph">
<p>Quarkus uses <a href="https://microprofile.io/project/eclipse/microprofile-config">MicroProfile Config</a> annotations to inject the configuration properties in the application.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Append the following property to your <code>application.properties</code>:</p>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">## custom properties
hello.message = ${HELLO_MESSAGE:hello}</code></pre>
</div>
</div>
</li>
<li>
<p>Again and if you already closed it, navigate to <code>src → main → java → com.redhat.atomic.fruit</code> and double click on <code>FruitResource.java</code>. Update with the following code replacing all the existing code:</p>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package com.redhat.atomic.fruit;

import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;

import org.jboss.logging.Logger; // logging <i class="conum" data-value="1"></i><b>(1)</b>
import org.eclipse.microprofile.config.inject.ConfigProperty; // custom property <i class="conum" data-value="2"></i><b>(2)</b>

@Path("/fruit")
public class FruitResource {
  Logger logger = Logger.getLogger(FruitResource.class); // logging <i class="conum" data-value="1"></i><b>(1)</b>

  @ConfigProperty(name = "hello.message") // custom property <i class="conum" data-value="2"></i><b>(2)</b>
  String message; // custom property <i class="conum" data-value="2"></i><b>(2)</b>

  @GET
  @Produces(MediaType.TEXT_PLAIN)
  public String hello() {
      logger.debug("Hello method is called with message: " + this.message); // logging &amp; custom property <i class="conum" data-value="1"></i><b>(1)</b> <i class="conum" data-value="2"></i><b>(2)</b>
      return message; // custom property <i class="conum" data-value="2"></i><b>(2)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Logging</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Custom property</td>
</tr>
</table>
</div>
</li>
<li>
<p>As usual, run this request from a different terminal.</p>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sh hljs" data-lang="sh">curl http://localhost:8080/fruit</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output should be something similar as follows (pay attention to the last trace, <strong>DEBUG</strong>):</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">2021-03-31 17:01:14,757 INFO  [io.qua.dep.dev.RuntimeUpdatesProcessor] (vert.x-worker-thread-8) Hot replace total time: 0.242s
2021-03-31 17:01:14,999 INFO  [io.qua.dep.dev.RuntimeUpdatesProcessor] (vert.x-worker-thread-9) Changed source files detected, recompiling [/projects/quarkus-zero-to-serverless-guide/atomic-fruit-service/src/main/java/com/redhat/atomic/fruit/FruitResource.java]
2021-03-31 17:01:15,100 INFO  [io.quarkus] (Quarkus Main Thread) atomic-fruit-service stopped in 0.000s
__  ____  __  _____   ___  __ ____  ______
 --/ __ \/ / / / _ | / _ \/ //_/ / / / __/
 -/ /_/ / /_/ / __ |/ , _/ ,&lt; / /_/ /\ \
--\___\_\____/_/ |_/_/|_/_/|_|\____/___/
2021-03-31 17:01:15,325 INFO  [io.quarkus] (Quarkus Main Thread) atomic-fruit-service 1.0-SNAPSHOT on JVM (powered by Quarkus 1.9.2.Final) started in 0.222s. Listening on: http://0.0.0.0:8080
2021-03-31 17:01:15,325 INFO  [io.quarkus] (Quarkus Main Thread) Profile dev activated. Live Coding activated.
2021-03-31 17:01:15,325 INFO  [io.quarkus] (Quarkus Main Thread) Installed features: [cdi, resteasy]
2021-03-31 17:01:15,325 INFO  [io.qua.dep.dev.RuntimeUpdatesProcessor] (vert.x-worker-thread-9) Hot replace total time: 0.327s
2021-03-31 17:01:15,334 DEBUG [com.red.ato.fru.FruitResource] (executor-thread-199) Hello method is called with message: hello</code></pre>
</div>
</div>
</li>
<li>
<p>Now, without stopping our application, change the value of <code>hello.message</code> in <code>atomic-fruit-service/src/main/resources/application.properties</code> from hello to <em>something different</em> you may prefer. Save the aplication.propertlies file and try again.</p>
<div class="paragraph">
<p>This time the result should be different (pay attention to the last trace, <strong>DEBUG</strong>):</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">2021-03-31 17:05:06,395 INFO  [io.qua.dep.dev.RuntimeUpdatesProcessor] (vert.x-worker-thread-10) File change detected: /projects/quarkus-zero-to-serverless-guide/atomic-fruit-service/src/main/resources/application.properties
2021-03-31 17:05:06,396 INFO  [io.quarkus] (Quarkus Main Thread) atomic-fruit-service stopped in 0.000s
__  ____  __  _____   ___  __ ____  ______
 --/ __ \/ / / / _ | / _ \/ //_/ / / / __/
 -/ /_/ / /_/ / __ |/ , _/ ,&lt; / /_/ /\ \
--\___\_\____/_/ |_/_/|_/_/|_|\____/___/
2021-03-31 17:05:06,534 INFO  [io.quarkus] (Quarkus Main Thread) atomic-fruit-service 1.0-SNAPSHOT on JVM (powered by Quarkus 1.9.2.Final) started in 0.136s. Listening on: http://0.0.0.0:8080
2021-03-31 17:05:06,534 INFO  [io.quarkus] (Quarkus Main Thread) Profile dev activated. Live Coding activated.
2021-03-31 17:05:06,534 INFO  [io.quarkus] (Quarkus Main Thread) Installed features: [cdi, resteasy]
2021-03-31 17:05:06,534 INFO  [io.qua.dep.dev.RuntimeUpdatesProcessor] (vert.x-worker-thread-10) Hot replace total time: 0.140s
2021-03-31 17:05:06,537 DEBUG [com.red.ato.fru.FruitResource] (executor-thread-199) Hello method is called with message: something different</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Return the value of <code>hello.message</code> back to <code>hello</code> and stop the app with <strong><em>Ctrl+C</em></strong>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="01-setup.html" class="query-params-link">1. Setup</a></span>
  <span class="next"><a href="03-deploy-database.html" class="query-params-link">3. Adding a Data Base to our application</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../../_/js/vendor/clipboard.js"></script>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
